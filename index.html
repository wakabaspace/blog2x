<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog2X - ãƒ–ãƒ­ã‚°è¨˜äº‹ã‹ã‚‰Xãƒã‚¹ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=Outfit:wght@700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1D9BF0;
            --primary-light: #4AB3F4;
            --primary-dark: #1A8CD8;
            --secondary: #EFF9FF;
            --text: #0F1419;
            --text-light: #536471;
            --bg: #F7FBFF;
            --card: #FFFFFF;
            --border: #D4E9F7;
            --shadow: rgba(29, 155, 240, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-family: 'Outfit', 'Noto Sans JP', sans-serif;
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-weight: 800;
            letter-spacing: -1px;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1rem;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px var(--shadow);
            margin-bottom: 2rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--text);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(29, 155, 240, 0.1);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        small {
            color: var(--text-light);
            font-size: 0.875rem;
        }

        .button {
            padding: 0.75rem 2rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 24px;
            cursor: pointer;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .button:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .post-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.2s;
        }

        .post-card:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .post-text {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            color: var(--text);
            white-space: pre-wrap;
        }

        .post-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 1rem;
        }

        .char-count {
            font-weight: 600;
        }

        .char-count.over {
            color: #F4212E;
        }

        .copy-button {
            padding: 0.5rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .copy-button:hover {
            background: var(--primary-dark);
        }

        .image-preview {
            margin-top: 1rem;
            border-radius: 8px;
            overflow: hidden;
        }

        .image-preview img {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
        }

        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .image-item {
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .image-item:hover {
            border-color: var(--primary);
        }

        .image-item.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(29, 155, 240, 0.2);
            position: relative;
        }

        .image-item.selected::before {
            content: attr(data-order);
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            z-index: 1;
        }

        .image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .note {
            background: var(--secondary);
            border-left: 4px solid var(--primary);
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Blog2X</h1>
            <p class="subtitle">ãƒ–ãƒ­ã‚°è¨˜äº‹ã‹ã‚‰Xãƒã‚¹ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ</p>
        </header>

        <div class="card">
            <h2>ãƒ–ãƒ­ã‚°æƒ…å ±</h2>
            <div class="form-group">
                <label>ãƒ–ãƒ­ã‚°ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä»»æ„ï¼‰</label>
                <input type="text" id="blogTitle" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«">
            </div>
            <div class="form-group">
                <label>ãƒ–ãƒ­ã‚°URLï¼ˆä»»æ„ï¼‰</label>
                <input type="text" id="blogUrl" placeholder="https://...ï¼ˆå…¥åŠ›ã—ãªãã¦ã‚‚OKï¼‰">
                <small style="display: block; margin-top: 0.25rem; color: var(--text-light);">
                    â€»ãƒ—ãƒ­ãƒ•ã«ãƒ–ãƒ­ã‚°URLãŒã‚ã‚‹å ´åˆã¯ä¸è¦ã§ã™<br>
                    â€»ã“ã“ã«å…¥åŠ›ã™ã‚‹ã¨ã€ãƒã‚¹ãƒˆå€™è£œã«URLãŒå«ã¾ã‚Œã¾ã™
                </small>
            </div>
            <div class="form-group">
                <label>è¨˜äº‹æœ¬æ–‡ï¼ˆã¾ãŸã¯è¦ç‚¹ï¼‰</label>
                <textarea id="blogContent" placeholder="è¨˜äº‹ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„..."></textarea>
            </div>
            <div class="form-group">
                <label>ãƒã‚¹ãƒˆã®ãƒˆãƒ¼ãƒ³</label>
                <select id="postTone">
                    <option value="casual">ğŸ“¢ ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ï¼ˆè¦ªã—ã¿ã‚„ã™ã„ï¼‰</option>
                    <option value="formal">ğŸ’¼ ãƒ•ã‚©ãƒ¼ãƒãƒ«ï¼ˆä¸å¯§ãƒ»ãƒ“ã‚¸ãƒã‚¹ï¼‰</option>
                    <option value="empathy">ğŸ’­ å…±æ„Ÿå‹ï¼ˆæ‚©ã¿ãƒ»å›°ã‚Šã”ã¨ã«å¯„ã‚Šæ·»ã†ï¼‰</option>
                    <option value="discovery">ğŸ’¡ ç™ºè¦‹å‹ï¼ˆæ°—ã¥ããƒ»å­¦ã³ï¼‰</option>
                    <option value="simple">ğŸ¯ ã‚·ãƒ³ãƒ—ãƒ«ï¼ˆäº‹å®Ÿã‚’ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆã«ï¼‰</option>
                </select>
            </div>
            <div class="note">
                <strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆï¼š</strong> ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ä½¿ãˆã°ã€è‡ªå‹•ã§æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ï¼
            </div>
            <button class="button" onclick="generatePosts()">ãƒã‚¹ãƒˆå€™è£œã‚’ç”Ÿæˆ</button>
        </div>

        <div id="imageSection" class="card hidden">
            <h2>ç”»åƒã‚’é¸æŠï¼ˆæœ€å¤§4æšï¼‰</h2>
            <p style="color: var(--text-light); margin-bottom: 1rem; font-size: 0.9rem;">ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ/è§£é™¤ã§ãã¾ã™ã€‚é¸ã‚“ã é †ç•ªã«ç•ªå·ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
            <div class="images-grid" id="imagesGrid"></div>
        </div>

        <div id="postsArea"></div>
    </div>

    <script>
        let blogData = {
            title: '',
            url: '',
            content: '',
            images: [],
            selectedImages: []  // è¤‡æ•°é¸æŠç”¨ï¼ˆæœ€å¤§4æšï¼‰
        };

        window.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const title = params.get('title');
            const url = params.get('url');
            const content = params.get('content');
            const images = params.get('images');
            
            if (title) document.getElementById('blogTitle').value = decodeURIComponent(title);
            if (url) document.getElementById('blogUrl').value = decodeURIComponent(url);
            if (content) document.getElementById('blogContent').value = decodeURIComponent(content);
            
            if (images) {
                blogData.images = decodeURIComponent(images).split(',').filter(i => i);
                if (blogData.images.length > 0) displayImages();
            }
        });

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function generatePosts() {
            const title = document.getElementById('blogTitle').value;
            const url = document.getElementById('blogUrl').value;
            const content = document.getElementById('blogContent').value;
            const tone = document.getElementById('postTone').value;

            if (!content) {
                alert('è¨˜äº‹æœ¬æ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            blogData.title = title;
            blogData.url = url;
            blogData.content = content;

            const catchyParts = extractCatchyParts(content);
            const posts = createPostCandidates(title, url, catchyParts, tone);
            displayPosts(posts);
        }

        function extractCatchyParts(content) {
            const allParts = [];
            const sentences = content.split(/[ã€‚ï¼ï¼Ÿ\n]/);
            const ngWords = ['å›³', 'è¡¨', 'å‚ç…§', 'ä»¥ä¸‹', 'ä¸Šè¨˜', 'Fig', 'Table', 'â€»', 'ï¼Š'];
            const ngPhrases = ['æ¬¡å›ã®ã‚³ãƒ¡ãƒ³ãƒˆ', 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹', 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä¿å­˜', 'ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«ä¿å­˜', 'ã‚µã‚¤ãƒˆã‚’ä¿å­˜', 'å¿…é ˆé …ç›®', 'å…¥åŠ›ã—ã¦ãã ã•ã„', 'Cookie'];
            const validEndings = ['ã§ã™', 'ã¾ã™', 'ã§ã—ãŸ', 'ã¾ã—ãŸ', 'ã ', 'ã§ã‚ã‚‹', 'ãŸ', 'ã‚‹', 'ã„', 'ãªã„', 'ã‚ˆã­', 'ã­', 'ã‚ˆ', 'ã‹'];
            
            const isValid = (s) => {
                const t = s.trim();
                if (t.length < 30 || t.length > 150) return false;
                if (ngWords.some(ng => t.includes(ng))) return false;
                if (ngPhrases.some(ng => t.includes(ng))) return false;
                if (!validEndings.some(end => t.endsWith(end))) return false;
                if (/[0-9\.,ã€ã€‚ï¼ï¼Ÿ]$/.test(t)) return false;
                return true;
            };
            
            allParts.push(...sentences.filter(s => /\d+/.test(s) && isValid(s)));
            allParts.push(...sentences.filter(s => (s.includes('?') || s.includes('ï¼Ÿ')) && isValid(s)));
            allParts.push(...sentences.filter(s => (s.includes('å¤§åˆ‡') || s.includes('é‡è¦') || s.includes('ãƒã‚¤ãƒ³ãƒˆ') || s.includes('ã‚³ãƒ„') || s.includes('ç§˜è¨£') || s.includes('ãŠã™ã™ã‚')) && isValid(s)));
            allParts.push(...sentences.filter(s => (s.includes('ã§ãã‚‹') || s.includes('ãªã‚‹') || s.includes('ã«ãªã‚‹') || s.includes('åŠ¹æœ') || s.includes('ãƒ¡ãƒªãƒƒãƒˆ') || s.includes('å¤‰ã‚ã‚‹')) && isValid(s)));
            allParts.push(...sentences.filter(s => (s.includes('å®Ÿã¯') || s.includes('æ„å¤–ã¨') || s.includes('å®Ÿéš›') || s.includes('é©š') || s.includes('ç™ºè¦‹') || s.includes('æ°—ã¥')) && isValid(s)));
            allParts.push(...sentences.filter(s => (s.includes('ã™ã¹ã') || s.includes('ã—ã‚ˆã†') || s.includes('ã—ã¦ã¿') || s.includes('ãŠã™ã™ã‚') || s.includes('è©¦ã—')) && isValid(s)));
            allParts.push(...sentences.filter(s => isValid(s) && !allParts.includes(s)).slice(0, 20));
            
            const unique = [...new Set(allParts)].filter(p => p && p.trim().length > 0);
            return shuffleArray(unique).slice(0, 10);
        }

        function createPostCandidates(title, url, catchyParts, tone) {
            if (catchyParts.length === 0) {
                return ['è¨˜äº‹ã‹ã‚‰ã‚­ãƒ£ãƒƒãƒãƒ¼ãªéƒ¨åˆ†ã‚’æŠ½å‡ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚\n\nã‚‚ã†å°‘ã—é•·ã„æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'];
            }

            const allPosts = [];
            const urlLine = (url && url.trim()) ? `\n\n${url}` : '';
            let idx = 0;
            const next = () => catchyParts[idx++ % catchyParts.length];

            switch(tone) {
                case 'casual':
                    allPosts.push(`${next()}\n\nã“ã‚Œã€ã‚ã£ã¡ã‚ƒå¤§äº‹ã ã¨æ€ã†ğŸ’¡${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œè‰¯ã„ã‚ˆã­${urlLine}`);
                    allPosts.push(`${next()}\n\nãƒã‚¸ã§ã“ã‚Œ${urlLine}`);
                    allPosts.push(`${next()}\n\nçŸ¥ã‚‰ãªã‹ã£ãŸã€œ${urlLine}`);
                    allPosts.push(`${next()}\n\nãªã‚‹ã»ã©ã£ã¦æ€ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nå‚è€ƒã«ãªã‚‹ï¼${urlLine}`);
                    allPosts.push(`${next()}\n\nè©¦ã—ã¦ã¿ãŸã„ãª${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œä½¿ãˆãã†${urlLine}`);
                    allPosts.push(`${next()}\n\næ°—ã¥ã‹ãªã‹ã£ãŸğŸ’¡${urlLine}`);
                    allPosts.push(`${next()}\n\nã„ã„ã“ã¨èã„ãŸ${urlLine}`);
                    allPosts.push(`æœ€è¿‘æ°—ã¥ã„ãŸã“ã¨\n\n${next()}${urlLine}`);
                    allPosts.push(`ä»Šæ—¥ã®ç™ºè¦‹ğŸ’¡\n\n${next()}${urlLine}`);
                    allPosts.push(`ãƒ¡ãƒ¢ğŸ“\n\n${next()}${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œè¦šãˆã¨ã“${urlLine}`);
                    allPosts.push(`${next()}\n\nã‚·ã‚§ã‚¢ã—ã¨ã${urlLine}`);
                    allPosts.push(`${next()}\n\næ„å¤–ã¨çŸ¥ã‚‰ã‚Œã¦ãªã„${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œä¾¿åˆ©${urlLine}`);
                    allPosts.push(`${next()}\n\næ—©é€Ÿã‚„ã£ã¦ã¿ã‚‹${urlLine}`);
                    allPosts.push(`${next()}\n\nã‚ã‚‹ã‚ã‚‹ã ã‚ˆã­${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã†ã„ã†ã®å¾…ã£ã¦ãŸ${urlLine}`);
                    if (title) allPosts.push(`${title}ã«ã¤ã„ã¦è€ƒãˆã¦ãŸ\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã€æ„å¤–ã¨å¥¥æ·±ã„\n\n${next()}${urlLine}`);
                    allPosts.push(`æœ€è¿‘å­¦ã‚“ã ã“ã¨ğŸ’¡\n\n${next()}${urlLine}`);
                    allPosts.push(`å¿˜ã‚Œãªã„ã†ã¡ã«ãƒ¡ãƒ¢\n\n${next()}${urlLine}`);
                    allPosts.push(`ã“ã‚ŒçŸ¥ã£ã¦ã‚‹ï¼Ÿ\n\n${next()}${urlLine}`);
                    if (catchyParts.length >= 2) {
                        const c1 = next(); const c2 = next();
                        allPosts.push(`${c1}\n\nç‰¹ã«${c2}ã£ã¦ã®ãŒè‰¯ã„${urlLine}`);
                        allPosts.push(`æ°—ã¥ã„ãŸã“ã¨2ã¤\n\nãƒ»${c1}\nãƒ»${c2}${urlLine}`);
                    }
                    break;
                    
                case 'formal':
                    allPosts.push(`${next()}\n\nã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nãŠå½¹ã«ç«‹ã¦ã‚Œã°å¬‰ã—ã„ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nå‚è€ƒæƒ…å ±ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nã”ä¸€èª­ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nçŸ¥è¦‹ã‚’å…±æœ‰ã„ãŸã—ã¾ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\næƒ…å ±æä¾›ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nã”ç¢ºèªãã ã•ã„ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nå‚è€ƒã¾ã§ã«ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\næ•´ç†ã—ã¾ã—ãŸã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\nã¾ã¨ã‚ã¾ã—ãŸã€‚${urlLine}`);
                    if (title) allPosts.push(`ã€${title}ã€‘\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã«ã¤ã„ã¦\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã«é–¢ã™ã‚‹è€ƒå¯Ÿ\n\n${next()}${urlLine}`);
                    allPosts.push(`${next()}\n\nä»¥ä¸Šã€ã”å‚è€ƒã¾ã§ã€‚${urlLine}`);
                    allPosts.push(`${next()}\n\næ‰€æ„Ÿã‚’è¿°ã¹ã¾ã—ãŸã€‚${urlLine}`);
                    allPosts.push(`é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ\n\n${next()}${urlLine}`);
                    allPosts.push(`æœ¬æ—¥ã®æ°—ã¥ã\n\n${next()}${urlLine}`);
                    allPosts.push(`å‚™å¿˜éŒ²\n\n${next()}${urlLine}`);
                    allPosts.push(`çŸ¥è¦‹ã®å…±æœ‰\n\n${next()}${urlLine}`);
                    allPosts.push(`å­¦ã³ã®è¨˜éŒ²\n\n${next()}${urlLine}`);
                    if (catchyParts.length >= 2) {
                        const c1 = next(); const c2 = next();
                        allPosts.push(`ãƒã‚¤ãƒ³ãƒˆ\n\nãƒ»${c1}\nãƒ»${c2}${urlLine}`);
                        allPosts.push(`è¦ç‚¹ã‚’ã¾ã¨ã‚ã¾ã—ãŸ\n\nãƒ»${c1}\nãƒ»${c2}${urlLine}`);
                    }
                    break;
                    
                case 'empathy':
                    allPosts.push(`${next()}\n\nåŒã˜ã‚ˆã†ã«æ„Ÿã˜ã¦ã‚‹äººã„ã‚‹ã‹ãªï¼Ÿ${urlLine}`);
                    allPosts.push(`${next()}\n\nã‚ã‹ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ${urlLine}`);
                    allPosts.push(`${next()}\n\nç§ã ã‘ã˜ã‚ƒãªã„ã‚ˆã­ï¼Ÿ${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œã€ã‚ã‚‹ã‚ã‚‹ã ã¨æ€ã†${urlLine}`);
                    allPosts.push(`${next()}\n\nå…±æ„Ÿã—ã¦ãã‚Œã‚‹äººã„ãŸã‚‰å¬‰ã—ã„${urlLine}`);
                    allPosts.push(`${next()}\n\nã¿ã‚“ãªã¯ã©ã†æ€ã†ï¼Ÿ${urlLine}`);
                    allPosts.push(`${next()}\n\nåŒã˜çµŒé¨“ã‚ã‚‹äººã„ãã†${urlLine}`);
                    allPosts.push(`${next()}\n\nç§ã‚‚ãã†ã ã£ãŸãª${urlLine}`);
                    allPosts.push(`${next()}\n\nèª°ã‹ã®å‚è€ƒã«ãªã‚Œã°${urlLine}`);
                    allPosts.push(`${next()}\n\nå°‘ã—ã§ã‚‚å½¹ã«ç«‹ã¦ã°å¬‰ã—ã„ã§ã™${urlLine}`);
                    if (title) allPosts.push(`${title}ã£ã¦ã€æ„å¤–ã¨é›£ã—ã„ã§ã™ã‚ˆã­\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã«ã¤ã„ã¦ã€ç§ãªã‚Šã«è€ƒãˆã¦ã¿ã¾ã—ãŸ\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã§æ‚©ã‚“ã§ã‚‹äººã¸\n\n${next()}${urlLine}`);
                    allPosts.push(`${next()}\n\nä¸€ç·’ã«ãŒã‚“ã°ã‚Šã¾ã—ã‚‡ã†${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œã€ç§ã‚‚çŸ¥ã‚ŠãŸã‹ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nåŒã˜æ°—æŒã¡ã®äººã„ã‚‹ã¯ãš${urlLine}`);
                    allPosts.push(`${next()}\n\nã¿ã‚“ãªã‚‚æ‚©ã‚“ã§ã‚‹ã‚ˆã­ï¼Ÿ${urlLine}`);
                    allPosts.push(`${next()}\n\nç§ã®çµŒé¨“ãŒå½¹ç«‹ã¦ã°${urlLine}`);
                    allPosts.push(`${next()}\n\nå°‘ã—ã§ã‚‚ãƒ’ãƒ³ãƒˆã«ãªã‚Œã°${urlLine}`);
                    allPosts.push(`${next()}\n\næ°—æŒã¡ã‚ã‹ã‚Šã¾ã™${urlLine}`);
                    if (catchyParts.length >= 2) {
                        const c1 = next(); const c2 = next();
                        allPosts.push(`${c1}\n\nã‚ã¨ã€${c2}ã‚‚é‡è¦ã ã¨æ€ã†${urlLine}`);
                    }
                    break;
                    
                case 'discovery':
                    allPosts.push(`ä»Šæ—¥ã®æ°—ã¥ãğŸ’¡\n\n${next()}${urlLine}`);
                    allPosts.push(`ç™ºè¦‹ï¼š${next()}${urlLine}`);
                    allPosts.push(`${next()}\n\næ„å¤–ã¨çŸ¥ã‚‰ãªã‹ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œã¯çŸ¥ã£ã¦ãŠããŸã„${urlLine}`);
                    allPosts.push(`${next()}\n\nå‹‰å¼·ã«ãªã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nã¸ã‡ã€œã£ã¦æ€ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\næ–°ã—ã„ç™ºè¦‹${urlLine}`);
                    allPosts.push(`${next()}\n\nç›®ã‹ã‚‰é±—${urlLine}`);
                    allPosts.push(`${next()}\n\nãªã‚‹ã»ã©ï¼${urlLine}`);
                    allPosts.push(`${next()}\n\nãã†ã„ã†ã“ã¨ã‹${urlLine}`);
                    allPosts.push(`${next()}\n\nåˆã‚ã¦çŸ¥ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\né¢ç™½ã„ç™ºè¦‹${urlLine}`);
                    allPosts.push(`${next()}\n\nã“ã‚Œèˆˆå‘³æ·±ã„${urlLine}`);
                    allPosts.push(`${next()}\n\næ·±æ˜ã‚Šã—ã¦ã¿ãŸ${urlLine}`);
                    if (title) allPosts.push(`${title}ã«ã¤ã„ã¦èª¿ã¹ã¦ã‚ã‹ã£ãŸã“ã¨\n\n${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}ã‚’æ·±æ˜ã‚Šã—ã¦ã¿ãŸçµæœ\n\n${next()}${urlLine}`);
                    allPosts.push(`${next()}\n\nèª¿ã¹ã¦ã‚ˆã‹ã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nçŸ¥è­˜ãŒå¢—ãˆãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nå­¦ã³ã«ãªã£ãŸ${urlLine}`);
                    allPosts.push(`${next()}\n\nç†è§£ãŒæ·±ã¾ã£ãŸ${urlLine}`);
                    if (catchyParts.length >= 2) {
                        const c1 = next(); const c2 = next();
                        allPosts.push(`ç™ºè¦‹ã—ãŸã“ã¨\n\nâœ“ ${c1}\nâœ“ ${c2}${urlLine}`);
                        allPosts.push(`å­¦ã‚“ã ã“ã¨\n\n${c1}\n\nã‚ã¨ã€${c2}${urlLine}`);
                    }
                    break;
                    
                case 'simple':
                    allPosts.push(`${next()}${urlLine}`);
                    if (title) allPosts.push(`${title}\n\n${next()}${urlLine}`);
                    allPosts.push(`${next()}ã€‚${urlLine}`);
                    allPosts.push(`${next()}ã§ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}ã¨æ€ã„ã¾ã™ã€‚${urlLine}`);
                    allPosts.push(`${next()}ã§ã™ã­ã€‚${urlLine}`);
                    allPosts.push(`ğŸ“ ${next()}${urlLine}`);
                    allPosts.push(`ğŸ’¡ ${next()}${urlLine}`);
                    allPosts.push(`âœ“ ${next()}${urlLine}`);
                    allPosts.push(`ãƒ¡ãƒ¢ï¼š${next()}${urlLine}`);
                    allPosts.push(`å‚™å¿˜éŒ²ï¼š${next()}${urlLine}`);
                    allPosts.push(`è¦ç‚¹ï¼š${next()}${urlLine}`);
                    allPosts.push(`ãƒã‚¤ãƒ³ãƒˆï¼š${next()}${urlLine}`);
                    allPosts.push(`ã¾ã¨ã‚ï¼š${next()}${urlLine}`);
                    allPosts.push(`é‡è¦ï¼š${next()}${urlLine}`);
                    if (catchyParts.length >= 2) {
                        const c1 = next(); const c2 = next();
                        allPosts.push(`ãƒ»${c1}\nãƒ»${c2}${urlLine}`);
                        allPosts.push(`1. ${c1}\n2. ${c2}${urlLine}`);
                    }
                    if (catchyParts.length >= 3) {
                        const c1 = next(); const c2 = next(); const c3 = next();
                        allPosts.push(`ãƒ»${c1}\nãƒ»${c2}\nãƒ»${c3}${urlLine}`);
                    }
                    break;
            }
            
            return shuffleArray(allPosts.filter(p => p && p.trim().length > 0)).slice(0, 5);
        }

        function displayPosts(posts) {
            const area = document.getElementById('postsArea');
            
            // é¸æŠã•ã‚ŒãŸç”»åƒã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼HTML
            let imagesPreviewHtml = '';
            if (blogData.selectedImages.length > 0) {
                imagesPreviewHtml = `
                    <div class="image-preview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem;">
                        ${blogData.selectedImages.map(img => `
                            <img src="${img}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px;">
                        `).join('')}
                    </div>
                `;
            }
            
            area.innerHTML = `
                <div class="card">
                    <h2>ãƒã‚¹ãƒˆå€™è£œ</h2>
                    ${posts.map((post, i) => {
                        const count = post.length;
                        const over = count > 280;
                        return `
                            <div class="post-card">
                                <div class="post-meta">
                                    <span>ãƒ‘ã‚¿ãƒ¼ãƒ³ ${i + 1}</span>
                                    <span class="char-count ${over ? 'over' : ''}">${count} / 280æ–‡å­—</span>
                                </div>
                                <div class="post-text">${post}</div>
                                ${imagesPreviewHtml}
                                <button class="copy-button" onclick="copyPost(\`${post.replace(/`/g, '\\`').replace(/\$/g, '\\$')}\`)">ã‚³ãƒ”ãƒ¼</button>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function displayImages() {
            const section = document.getElementById('imageSection');
            const grid = document.getElementById('imagesGrid');
            
            if (blogData.images.length === 0) {
                section.classList.add('hidden');
                return;
            }
            
            section.classList.remove('hidden');
            grid.innerHTML = blogData.images.map((img, i) => `
                <div class="image-item" onclick="selectImage('${img}', ${i})">
                    <img src="${img}">
                </div>
            `).join('');
        }

        function selectImage(url, index) {
            const imgIndex = blogData.selectedImages.indexOf(url);
            
            if (imgIndex > -1) {
                // ã™ã§ã«é¸æŠã•ã‚Œã¦ã„ã‚‹ â†’ è§£é™¤
                blogData.selectedImages.splice(imgIndex, 1);
            } else {
                // æœªé¸æŠ â†’ è¿½åŠ ï¼ˆæœ€å¤§4æšã¾ã§ï¼‰
                if (blogData.selectedImages.length < 4) {
                    blogData.selectedImages.push(url);
                } else {
                    alert('ç”»åƒã¯æœ€å¤§4æšã¾ã§é¸æŠã§ãã¾ã™');
                    return;
                }
            }
            
            // é¸æŠçŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.image-item').forEach((item, i) => {
                const imgUrl = blogData.images[i];
                if (blogData.selectedImages.includes(imgUrl)) {
                    item.classList.add('selected');
                    // é¸æŠé †ã‚’è¡¨ç¤º
                    const order = blogData.selectedImages.indexOf(imgUrl) + 1;
                    item.setAttribute('data-order', order);
                } else {
                    item.classList.remove('selected');
                    item.removeAttribute('data-order');
                }
            });
        }

        function copyPost(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            }).catch(() => {
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ');
            });
        }
    </script>
</body>
</html>
